name: "Docker Image Get Tag"
description: "Use the GitHub refs to determine the tag for a docker image."

outputs:
  tag_name:
    description: "tag to use for the docker image"
    value: ${{ steps.get-tag.outputs.tag_name }}

runs:
  using: "composite"
  steps:
    - name: Determine tag
      id: get_tag
      shell: bash
      run: |
        REF="$GITHUB_REF"
        if [ "$GITHUB_HEAD_REF" != "" ]; then
          REF="$GITHUB_HEAD_REF"
        fi
        if [ $REF == 'refs/heads/devel' ]
        then
          echo "::set-output name=tag_name::latest"
        else
          echo "::set-output name=tag_name::$(basename $REF)"
        fi